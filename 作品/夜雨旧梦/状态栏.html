```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>夜雨旧梦 - 状态栏</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
      :root {
        /* 赛博朋克2077风配色 - 柔和版 */
        --bg-color: transparent;
        --card-bg-color: #080306; /* 更深的黑红底色 */
        --text-color: #e85d4a; /* 橘红色文字 - 提高辨识度 */
        --text-secondary-color: #a84436; /* 暗橘红文字 */
        --accent-cyan: #00b8cc; /* 柔和赛博青蓝 */
        --accent-yellow: #d4c408; /* 柔和赛博黄 */
        --border-color: #2a0a10; /* 更深的红边框 */
        --border-color-strong: #421018; /* 柔和强红边框 */
        --progress-bar-bg: #0f0305; /* 更深的进度条背景 */
        --warning-color: #d4c408; /* 柔和警告黄 */
      }

      body {
        font-family: 'Microsoft YaHei', 'SimHei', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: transparent;
        color: var(--text-color);
        margin: 0;
        padding: 10px;
        box-sizing: border-box;
      }

      .status-card {
        position: relative;
        background:
          linear-gradient(135deg, rgba(232, 93, 74, 0.08) 0%, rgba(0, 184, 204, 0.06) 100%),
          linear-gradient(180deg, rgba(66, 16, 24, 0.7), rgba(8, 3, 6, 0.98)),
          var(--card-bg-color);
        border-radius: 0;
        border: 2px solid var(--border-color-strong);
        box-shadow:
          0 0 20px rgba(232, 93, 74, 0.2),
          0 10px 40px rgba(0, 0, 0, 0.95),
          inset 0 1px 0 rgba(232, 93, 74, 0.1);
        overflow: hidden;
      }

      /* 扫描线效果 */
      .status-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent);
        pointer-events: none;
        z-index: 10;
        animation: scan 4s linear infinite;
      }

      @keyframes scan {
        0% {
          transform: translateY(0);
          opacity: 0.5;
        }
        100% {
          transform: translateY(500px);
          opacity: 0;
        }
      }

      /* 赛博光晕效果 */
      .status-card::after {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(232, 93, 74, 0.05) 0%, transparent 70%);
        animation: pulse 4s ease-in-out infinite;
        pointer-events: none;
        z-index: 0;
      }

      @keyframes pulse {
        0%, 100% { opacity: 0.3; transform: scale(1); }
        50% { opacity: 0.5; transform: scale(1.02); }
      }

      .tab-buttons {
        display: flex;
        gap: 6px;
        padding: 10px 10px 0 10px;
        background: linear-gradient(180deg, rgba(0, 0, 0, 0.4), transparent);
        border-bottom: 2px solid var(--border-color-strong);
        position: relative;
        z-index: 2;
      }

      .tab-button {
        flex: 1;
        padding: 12px 10px;
        background: linear-gradient(180deg, rgba(66, 16, 24, 0.5), rgba(13, 5, 8, 0.8));
        border: 1px solid var(--border-color);
        border-bottom: 2px solid transparent;
        color: var(--text-secondary-color);
        cursor: pointer;
        font-size: 14px;
        font-weight: 700;
        letter-spacing: 2px;
        transition: all 0.2s ease;
        text-align: center;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }

      .tab-button i {
        font-size: 18px;
        opacity: 0.7;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        line-height: 1;
      }

      .tab-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 184, 204, 0.15), transparent);
        transition: left 0.4s ease;
      }

      .tab-button:hover {
        color: var(--accent-cyan);
        border-color: var(--accent-cyan);
        box-shadow:
          0 0 10px rgba(0, 184, 204, 0.35),
          inset 0 0 6px rgba(0, 184, 204, 0.08);
        text-shadow: 0 0 5px rgba(0, 184, 204, 0.7);
      }

      .tab-button:hover::before {
        left: 100%;
      }

      .tab-button:hover i {
        opacity: 1;
        filter: drop-shadow(0 0 4px var(--accent-cyan));
      }

      .tab-button.active {
        color: var(--accent-cyan);
        background: linear-gradient(180deg, rgba(0, 184, 204, 0.12), rgba(0, 184, 204, 0.06));
        border-color: var(--accent-cyan);
        border-bottom-color: var(--accent-cyan);
        box-shadow:
          0 0 15px rgba(0, 184, 204, 0.5),
          inset 0 2px 6px rgba(0, 184, 204, 0.18);
        text-shadow: 0 0 8px rgba(0, 184, 204, 0.8);
      }

      .tab-button.active i {
        opacity: 1;
        filter: drop-shadow(0 0 6px var(--accent-cyan));
      }

      .card-body {
        padding: 18px;
        position: relative;
        z-index: 2;
      }

      .tab-content {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(15px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .property {
        margin-bottom: 18px;
        padding: 12px;
        background:
          linear-gradient(135deg, rgba(232, 93, 74, 0.1), rgba(0, 184, 204, 0.05)),
          rgba(10, 5, 8, 0.6);
        border-left: 3px solid var(--text-color);
        border-radius: 0;
        box-shadow: inset 0 1px 0 rgba(232, 93, 74, 0.12);
        transition: all 0.2s ease;
      }

      .property:hover {
        border-left-color: var(--accent-cyan);
        background:
          linear-gradient(135deg, rgba(0, 184, 204, 0.12), rgba(232, 93, 74, 0.06)),
          rgba(10, 5, 8, 0.7);
        box-shadow:
          inset 0 1px 0 rgba(0, 184, 204, 0.18),
          0 0 8px rgba(0, 184, 204, 0.2);
      }

      .property:last-child {
        margin-bottom: 0;
      }

      .property-name {
        font-size: 13px;
        color: var(--text-secondary-color);
        display: block;
        margin-bottom: 8px;
        letter-spacing: 2px;
        font-weight: 600;
        text-transform: uppercase;
      }

      .value-main {
        font-size: 15px;
        font-weight: 600;
        color: var(--accent-cyan);
        line-height: 1.6;
        text-shadow: 0 0 3px rgba(0, 184, 204, 0.4);
      }

      .value-number {
        display: inline-block;
        padding: 4px 12px;
        background: linear-gradient(135deg, rgba(0, 184, 204, 0.15), rgba(0, 184, 204, 0.06));
        border: 1px solid var(--accent-cyan);
        border-radius: 0;
        color: var(--accent-cyan);
        font-weight: 700;
        font-size: 16px;
        text-shadow: 0 0 6px rgba(0, 184, 204, 0.7);
        box-shadow: 0 0 10px rgba(0, 184, 204, 0.3);
      }

      /* 道具和通讯录列表 */
      .list-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .list-item {
        padding: 14px;
        background:
          linear-gradient(135deg, rgba(232, 93, 74, 0.09), rgba(0, 184, 204, 0.05)),
          rgba(10, 5, 8, 0.65);
        border: 1px solid var(--border-color-strong);
        border-left: 3px solid var(--text-color);
        border-radius: 0;
        transition: all 0.2s ease;
      }

      .list-item:hover {
        border-left-color: var(--accent-cyan);
        box-shadow:
          0 0 12px rgba(0, 184, 204, 0.28),
          inset 0 0 8px rgba(0, 184, 204, 0.06);
      }

      .list-item-title {
        font-size: 15px;
        font-weight: 700;
        color: var(--accent-cyan);
        margin-bottom: 6px;
        text-shadow: 0 0 5px rgba(0, 184, 204, 0.6);
      }

      .list-item-desc {
        font-size: 13px;
        color: var(--text-color);
        line-height: 1.5;
      }

      .progress-bar-container {
        width: 100%;
        background-color: var(--progress-bar-bg);
        border: 1px solid var(--border-color-strong);
        border-radius: 3px;
        height: 14px;
        margin-top: 10px;
        overflow: hidden;
        position: relative;
        box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.6);
      }

      .progress-bar-value {
        height: 100%;
        background: linear-gradient(90deg, var(--text-color), var(--accent-cyan));
        box-shadow:
          0 0 12px rgba(0, 184, 204, 0.6),
          inset 0 1px 0 rgba(0, 184, 204, 0.3);
        transition: width 0.8s ease-in-out;
        position: relative;
      }

      .progress-bar-value::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent 0%, rgba(0, 184, 204, 0.4) 50%, transparent 100%);
        animation: shimmer 2.5s infinite;
      }

      @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      /* 响应式设计 */
      @media (max-width: 768px) {
        .card-body {
          padding: 14px;
        }

        .tab-button {
          padding: 10px 8px;
          font-size: 12px;
        }
      }

      @media (max-width: 480px) {
        .card-body {
          padding: 12px;
        }

        .tab-button {
          padding: 8px 6px;
          font-size: 11px;
          letter-spacing: 1px;
        }

        .property {
          margin-bottom: 14px;
          padding: 10px;
        }

        .property-name {
          font-size: 12px;
        }

        .value-main {
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <div class="status-card" id="status-card">
      <div class="tab-buttons">
        <button id="btn-world" class="tab-button" onclick="switchTab('world')">
          <i class="ri-global-line"></i>世界
        </button>
        <button id="btn-mengyu" class="tab-button" onclick="switchTab('mengyu')">
          <i class="ri-user-3-line"></i>梦雨
        </button>
        <button id="btn-mainquest" class="tab-button" onclick="switchTab('mainquest')">
          <i class="ri-flashlight-line"></i>主线
        </button>
        <button id="btn-items" class="tab-button" onclick="switchTab('items')">
          <i class="ri-suitcase-line"></i>道具
        </button>
        <button id="btn-contacts" class="tab-button" onclick="switchTab('contacts')">
          <i class="ri-contacts-book-2-line"></i>通讯录
        </button>
      </div>

      <div class="card-body">
        <div id="tab-world" class="tab-content">
          <div class="property">
            <span class="property-name">时间</span>
            <span id="world-time" class="value-main"></span>
          </div>
          <div class="property">
            <span class="property-name">地点</span>
            <span id="world-location" class="value-main"></span>
          </div>
        </div>

        <div id="tab-mengyu" class="tab-content">
          <div class="property">
            <span class="property-name">状态</span>
            <span id="mengyu-status" class="value-main"></span>
          </div>
          <div class="property">
            <span class="property-name">穿着</span>
            <span id="mengyu-outfit" class="value-main"></span>
          </div>
          <div class="property">
            <span class="property-name">好感度</span>
            <div style="display: flex; align-items: center; gap: 12px;">
              <span id="mengyu-affection" class="value-number"></span>
            </div>
            <div class="progress-bar-container">
              <div id="affection-bar" class="progress-bar-value" style="width: 0%;"></div>
            </div>
          </div>
        </div>

        <div id="tab-mainquest" class="tab-content">
          <div class="property">
            <span class="property-name">任务标题</span>
            <span id="quest-title" class="value-main" style="color: var(--accent-yellow); font-size: 17px; text-shadow: 0 0 8px rgba(212, 196, 8, 0.6);"></span>
          </div>
          <div class="property">
            <span class="property-name">任务描述</span>
            <span id="quest-desc" class="value-main" style="line-height: 1.8;"></span>
          </div>
        </div>

        <div id="tab-items" class="tab-content">
          <div id="items-list" class="list-container">
            <div class="value-main" style="text-align: center; opacity: 0.6;">暂无道具</div>
          </div>
        </div>

        <div id="tab-contacts" class="tab-content">
          <div id="contacts-list" class="list-container">
            <div class="value-main" style="text-align: center; opacity: 0.6;">暂无联系人</div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function SafeGetValue(obj, path, defaultValue = 'N/A') {
        let keys = Array.isArray(path) ? path : path.split('.');
        let current = obj;
        for (let i = 0; i < keys.length; i++) {
          if (
            current === undefined ||
            current === null ||
            typeof current !== 'object' ||
            !current.hasOwnProperty(keys[i])
          ) {
            return defaultValue;
          }
          current = current[keys[i]];
        }
        if (current === undefined || current === null) {
          return defaultValue;
        }
        if (Array.isArray(current)) {
          if (current.length > 0) {
            const actualValue = current[0];
            if (typeof actualValue === 'boolean') {
              return actualValue;
            }
            return String(actualValue);
          } else {
            return defaultValue;
          }
        }
        if (typeof current === 'boolean') {
          return current;
        }
        return String(current);
      }

      function GetRawValue(obj, path, defaultValue = null) {
        const keys = Array.isArray(path) ? path : path.split('.');
        let cur = obj;
        for (let i = 0; i < keys.length; i++) {
          if (!cur || typeof cur !== 'object' || !(keys[i] in cur)) return defaultValue;
          cur = cur[keys[i]];
        }
        return cur === undefined ? defaultValue : cur;
      }

      function updateTextField(elementId, value) {
        const el = document.getElementById(elementId);
        if (el) {
          el.innerText = value === undefined || value === null ? 'N/A' : String(value);
        }
      }

      function updateProgressBar(barId, valueId, rawValue, min, max) {
        const progressBar = document.getElementById(barId);
        const valueDisplay = document.getElementById(valueId);
        if (!valueDisplay) return;

        const displayText = rawValue === undefined || rawValue === null ? String(min) : String(rawValue);
        valueDisplay.innerText = displayText;

        let numericValue = min;
        if (typeof rawValue === 'number') {
          numericValue = rawValue;
        } else if (typeof rawValue === 'string') {
          const m = rawValue.match(/-?\d+(?:\.\d+)?/);
          if (m) numericValue = parseFloat(m[0]);
        } else if (!isNaN(Number(rawValue))) {
          numericValue = Number(rawValue);
        }

        if (progressBar) {
          numericValue = Math.max(min, Math.min(max, numericValue));
          const range = max - min;
          const percentage = range === 0 ? (numericValue >= max ? 100 : 0) : ((numericValue - min) / range) * 100;
          progressBar.style.width = `${Math.max(0, Math.min(100, percentage))}%`;
        }
      }

      function updateItemsList(itemsObj) {
        const container = document.getElementById('items-list');
        if (!container) return;

        if (!itemsObj || typeof itemsObj !== 'object' || Object.keys(itemsObj).length === 0) {
          container.innerHTML = '<div class="value-main" style="text-align: center; opacity: 0.6;">暂无道具</div>';
          return;
        }

        let html = '';
        for (const [name, desc] of Object.entries(itemsObj)) {
          html += `
            <div class="list-item">
              <div class="list-item-title">${name}</div>
              <div class="list-item-desc">${desc || 'N/A'}</div>
            </div>
          `;
        }
        container.innerHTML = html || '<div class="value-main" style="text-align: center; opacity: 0.6;">暂无道具</div>';
      }

      function updateContactsList(contactsObj) {
        const container = document.getElementById('contacts-list');
        if (!container) return;

        if (!contactsObj || typeof contactsObj !== 'object' || Object.keys(contactsObj).length === 0) {
          container.innerHTML = '<div class="value-main" style="text-align: center; opacity: 0.6;">暂无联系人</div>';
          return;
        }

        let html = '';
        for (const [name, intro] of Object.entries(contactsObj)) {
          html += `
            <div class="list-item">
              <div class="list-item-title">${name}</div>
              <div class="list-item-desc">${intro || 'N/A'}</div>
            </div>
          `;
        }
        container.innerHTML = html || '<div class="value-main" style="text-align: center; opacity: 0.6;">暂无联系人</div>';
      }

      async function initDisplay() {
        try {
          const messages = await getChatMessages(getCurrentMessageId());
          if (!messages || messages.length === 0 || !messages[0].data) {
            document.getElementById('status-card').innerHTML =
              "<p style='color:var(--accent-blood-red); padding:10px; text-align:center;'>无法加载状态数据</p>";
            return;
          }
          const gameData = messages[0].data;
          const characterData = gameData.stat_data;
          if (!characterData) {
            document.getElementById('status-card').innerHTML =
              "<p style='color:var(--accent-blood-red); padding:10px; text-align:center;'>数据缺失</p>";
            return;
          }

          // 世界信息
          updateTextField('world-time', SafeGetValue(characterData, '世界.时间'));
          updateTextField('world-location', SafeGetValue(characterData, '世界.地点'));

          // 沈梦雨信息
          updateTextField('mengyu-status', SafeGetValue(characterData, '沈梦雨.状态'));
          updateTextField('mengyu-outfit', SafeGetValue(characterData, '沈梦雨.穿着'));
          const affection = GetRawValue(characterData, '沈梦雨.好感度', 0);
          updateProgressBar('affection-bar', 'mengyu-affection', affection, 0, 100);

          // 道具列表
          updateItemsList(GetRawValue(characterData, '主角.重要道具列表', {}));

          // 通讯录列表
          updateContactsList(GetRawValue(characterData, '主角.通讯录列表', {}));

          // 主线任务
          updateTextField('quest-title', SafeGetValue(characterData, '主线.标题'));
          updateTextField('quest-desc', SafeGetValue(characterData, '主线.描述'));

          switchTab('world');
        } catch (error) {
          document.getElementById('status-card').innerHTML =
            `<p style='color:var(--accent-blood-red); padding:10px; text-align:center;'>加载出错: ${error.message}</p>`;
        }
      }

      function switchTab(tabId) {
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(content => {
          content.style.display = 'none';
        });

        const buttons = document.querySelectorAll('.tab-button');
        buttons.forEach(button => {
          button.classList.remove('active');
        });

        const selectedContent = document.getElementById('tab-' + tabId);
        if (selectedContent) {
          selectedContent.style.display = 'block';
        }

        const selectedButton = document.getElementById('btn-' + tabId);
        if (selectedButton) {
          selectedButton.classList.add('active');
        }
      }

      document.addEventListener('DOMContentLoaded', initDisplay);
    </script>
  </body>
</html>
```
